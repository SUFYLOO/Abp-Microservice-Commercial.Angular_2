using Shouldly;
using System;
using System.Linq;
using System.Threading.Tasks;
using Resume.ResumeSkills;
using Resume.EntityFrameworkCore;
using Xunit;

namespace Resume.ResumeSkills
{
    public class ResumeSkillRepositoryTests : ResumeEntityFrameworkCoreTestBase
    {
        private readonly IResumeSkillRepository _resumeSkillRepository;

        public ResumeSkillRepositoryTests()
        {
            _resumeSkillRepository = GetRequiredService<IResumeSkillRepository>();
        }

        [Fact]
        public async Task GetListAsync()
        {
            // Arrange
            await WithUnitOfWorkAsync(async () =>
            {
                // Act
                var result = await _resumeSkillRepository.GetListAsync(
                    resumeMainId: Guid.Parse("123d5662-b15e-47ce-84c0-010927dd94ac"),
                    computerSkills: "6a99ff99f7c64d5591eb4b19717f4844e0665026ea774064af81b7054f9b7ad360c7c14a6d6d482b8b61293d698d276c999e3a3348c540b0bc06ac610f42521ece722025cf30476b8393b142c091427c806661761dd54f5ba3b03d88472cdd92eaa80e32102e4db6a214c59975a13dd21f8145dfcd0a4ff7887c99a56b4809b88df990434782439d83922eb488b20c789151b2eecbc841fbbdcb49c5727a50a96d21a4dea47b4e7bba4f352cee69cbef03ff35e0ba594998a7e4a09fc11f8c9ce416fe6b6d614e5faea33ae5a9595a4defab5d476f8c4145921e1eafde3dae7863cfae72365b481e81ed53232bb5abf367d0059a36ab465c9f10",
                    computerSkillsEtc: "9920a060d6b34c68914834cad18185ea1308451e90914f359486902b6f3b68027f596c25d1b844baafbb0284d97cb40b6712cd61b82540c5853863643cb798d4043b34d549e644e19d8dcc402c1b8d3ec1eea62c59d341cf8a2151f1cfb9c5cbef683ff9e2754a69b2a40b51ac04faf36493f9b702c74ef2af2c770638e1722ea4abd6549fdd468198e1067173043e6df284aba7047b4204acde89fc37542b498ef4a91ee3884e948e5e6b6b75550a7ead8423de4931450fb331f2af2ed40dcb75cfea36534c45b99a8c2a3bed4c1497fe5dd851e6324244bce2abd496ea9ce1691fe2b70efc45b3bfe347990ea0914c387bb1f1701e48a38803",
                    chineseTypingCode: "ac50e1c4bf6b4b4d8b76be57b7ddc94e1b255e92927844c4a2",
                    professionalLicense: "5b5cfaa6fa2c4fce97f867dc3e9de7488663486244b045e894f878618a079e6edc6877932ed64b62b9eeb8a7c3be73f2cfb9bad1b3474aceaf59a37cdd455ca0165a53d89f3d4aa7a0fb602af2f2a0d4091110cc31de47e2801c5adeabb78eb420cfb46938484460a47b50acde923cfb4439c74c7eac44b6ab67edac6c5dd1fe59a30577a75a414c9ee25df687e43f8dab8ff6ee04584e438005572b7b22d7f9630df0ead64b4d58ab3e649b6dac3a84fec9c5659e6e4707b37d2dd135e7c562c2b936985d354a5c96e6d3d2e3888cb7cb284251a74348918f52bc8d2a0d66dc419ed1397b5c4774aa13514412210164b2389e6b368642c6a9f7",
                    professionalLicenseEtc: "45383399ed4d4a4d88e14a2b0ec5ee8b9b1dd77d5de7426ba1f0ec807fd61d143955f25336f54ff19881d368710ad0ed917381207b86461d83dfa42bd5d561775dd6fa9eb0054747a149e66d3dc8f23bad19e86ae04e4efd9812a1ee9181a462b001738000b5483498ba66ac4ac455b1283777f6bac44b99b3fcd315cb5609a4ea9fc3c40ae1455f80b13fdd77880c6ba1a59d39ec314317a40d221d2b15230edd05e161896b48bf80b935f026ed5baa66f3f0a65ab947ee8ffa92aedc58df25c9b7a05bf7504de484a63c4139f0e21114c103619c314e36a1581c7ded59325b705a7d1fa6f54218b501158ec0092af9459cdda36de64c4c8af0",
                    workSkills: "005ef4c232534933ae750ddaee7a315ef67a44ec9047423880f0112e55ef2dfb58306d2c4fde47f994dade46082de8b64f7930c45f51471bb4e8822039eb8f31fe044a8edd9b45d9a652bd8a0922cdf442283e3a4c1f448dacc01094362ed78c93b19e8701034b71a285dfbf5b1de3b8701d561f86c346e2b343ca194e314ebfe440a4aa6c3d408495fd46a636cf8d19ea42ba25e2694e46817be904bb6a535592554704740942babbc6864572a6e100093f1e6419304706aa78195c82b9e5bf1caabf73110347dda7bb2d6e19fe2cc2a3bc76852c1f4ed799e30a657ee316464e6446fde8bd41258269447a2bb97e7cbc6998c5a7e641f7b0d1",
                    workSkillsEtc: "14999f87475342af8068ac150027ce232b96019f164d44858966511b094a19942b7bc1fced65414d954dc4f40a361a4c90e30cbd4fae46f4904ef8f04cb5c08f96c557f5a52040aa9eef70b7eedb367fa6f7b188b5f94e62bab08254f96fb0e51031516ce8954f69a8bc258691966a546598e9dc2c574da4bd893eb6628a7d339695afa8cef747dd8746c81894e6ed93b9084d25202c4538b4573e30e626a49fdc02d9bdbb7c4b35bf63b1e3fa45a4dfd1fe5b6dca3140f297ac6b9becf69b0dbaf78dc817c64fa88e640ad4c0c236dcf42e444bae514877832ce3c0bfc16acbf9be1c1e22d04e84b61b834139ea8b50c0ecb0e511b146e3a645",
                    extendedInformation: "287beb00ca3548e8bae56a2f17def88fc206b1c918b0424abf557c9e2734e1260c075aafaf0c4446bc7a75b6f69c4d280f1ea48efce346a5b3c65edfe1bcdde785673997d84648e1965032afbda666e7d41ff93cc285407380c16eb01e14f0fa7200df3079a74f74a1386b499b303f4fe82412eaff42440cae969e33efa19f45ebdaaa41d8b04548b4436bd47542ff121f8c61a8d99a461d940d5d8acd20a45f692678e72da2400c80eed211631ee5a03d8896a944f3422692de9b3ecd5afba1edbf46242be34ebdb118f6631030ea20a9013b2e662d4a5694951e90c5a3860867cab03a96c341aead430d0c2e5371fbaee93881303c4f2a8894",
                    note: "15f85d77316a460ca5e2fe822ad7dc76b795678d3fbe417a9b382588e7aba10c68ee5672ac914f6d89df9dddd473ae66a103d1cfdba747a4a2676d2588ac35e531864c66e3a94a08ae6e621398ef21437cc9e149717a4d7788ba6ba4793519f4b8dba264b5e945988a6452aebb1fbad34529358559e74991aef00681f1296b463c455c2f932046b99eed30751420a226a496c6dfdc8d4011a0c798d6a3922c101c444046e00446c4a1cf6b7bd38d354f287f623898f84096b170e6666b0554ff792460bb52f44a478ce3b80ae170cb7adfe86215156a4b5aa027c784b27470fc3aa76e11855b440f9807c72bc55609b2133a10e9e1e4419a819b",
                    status: "13478c9a5dd8483291a22227f7ac9a7de6f0c73b8bda41c6a0"
                );

                // Assert
                result.Count.ShouldBe(1);
                result.FirstOrDefault().ShouldNotBe(null);
                result.First().Id.ShouldBe(Guid.Parse("b61993dd-2a9d-4053-8dc4-2cd38314d2d2"));
            });
        }

        [Fact]
        public async Task GetCountAsync()
        {
            // Arrange
            await WithUnitOfWorkAsync(async () =>
            {
                // Act
                var result = await _resumeSkillRepository.GetCountAsync(
                    resumeMainId: Guid.Parse("911bc471-496f-4de8-a4a6-b4fad7638fe8"),
                    computerSkills: "00bdb64a29c44323ad75cc01fa8c06f1a3e80681d9674f4eb75f63b9809a267b415f4d1599b549ff9b1848ed0a219093b4ea76528f6e4311a99a7fbb4319411a6e48906edf294c8d9eb4664107867b5232f39adb871e44ed831ca89c4c3d32970d34c92d69b04ea18abf6d8414368405c4f9775466e649aaa1c6a1381d7a9f4a335ed6874a7342e598f8f92aa40b4c811ae2a2b014364cf6b75617f280fe166102ab8314d881481ab2ac515f26ba709799526f44d28941c9813733ac10c9f1c645e150c36a704dfea698368a56a66337050aac9c4e3c42d1bca2cb05ffa2d77247ab5e9813b24aa7856ee62f362279ecd5fdfcee8de941198ea6",
                    computerSkillsEtc: "1c855bb70a434aff826e04c37ce224d1d8739132a0dd4f57a6488294358a3cf58b47a30989d4418d84b0e8010c42966a44644eb5aa764717bb3b8db8405af5a2f16421fddc864bea86cb204de49790a805acb1b87a68443793f2e41a78f289207b072f59599d47928db6278e0a1dd56bffc86a5dafc24400b2333640662048625cd2843a960e4b728f2550c4d2bef286dac8818b9ca944f1adac6563109497d8fe688c544d4e44f6b0f74afe56e97ee6f31561ebcea0432ea800ead3bf3469b52046b2811437428eac98c157225dbf26726b4795799944cc9297f3407b26e30eabdb08c42283475e804b1c6ba21d21a468855f7e2e37442ab54b",
                    chineseTypingCode: "714e42e1678f4fdeb61f70579a05dcb7df937ad0b3d24be4b3",
                    professionalLicense: "67b2a61725ef4159b0ea4055b5ca3752ba71f4cde024461595fbebc32f59a68502e07517104c4feeb4e7a907c8f2d8ba8c5569f60bc64de5ada58d2508cf9b1d4f0590cce7d647c09c9b557822794357a7ff9b56e58341d1bc0fd27009a42f5c7dc3ce79876543be85c4e7f6611d8c2217f51b737c064299802f6685e09dfb52824677ecfe92484eaec286b2346ccc61d09ee82c3979414c99ed59570db3416cee30147931d540818bc0e2484a6f58efa6e680a5c19c4e0aaa0bffbaf0d65dfb89855e38b5af4ada884bd6ea84bbb3bf0cfc08b3a9054ef688b7344b2b6c5d5d2d4b72bcbbdc4a1488f9e53f3ffd77eaa6af4c3312a34fa58e71",
                    professionalLicenseEtc: "50f6310f5594403d8912d0942e6cb086accc6a57e8d3467fbf0c0d72c813f4739ac4de90ef6e4da7ba0b50ced636ae3c9450ca872f35420ca86b50ba37c4ba155f2fdb686fb943cca5518d2c08fb38d1f17c89061ff94908a147d774eff348e1490b5ed1833a414dab252baa0e613f743d8f53a695614c13a90c21d8093fc1683eafd8f2c9d14502b68534e77a47e01a008a019b1fb84a69b3bd35b47a4839170448cd7cc74f473ca9f98387b8d9a429103c60cb25ac4411b7a6d312173e48776c610f28cec74974be02b1fb8fc4c4c4a97a6c6cb27c45c1be0ee6e77d93596a0b3622c6ab884899a75cebcf5836aec1edf81633e01747d4bfd4",
                    workSkills: "5a4ecc4f05624fefaada6f9bd961dd782967ba44a575408ba0b8d20e32eb9262f8c1d6af8dfd42c9adab3e3bb05df6f7129b119974ac4b24ac531343e44a0be41647a75c430c4d6b845694cc250125faf77f636f1e9549acb9f3fc7fd6a76a8a68bcee9cd8414f65a996836ab9d748c1207dae4f60d8434c99bfa5e068c1eba38c94651157734423b179637a3bd609512a3ff210d2d14bd397e6ae445a313662fdab671ce66842d5b1d152d6b79fcbca058815b4e4b84d79b15b4029bbfec1e69ea5d5a805f348e089f7e9cfa90d9f7cb0e4545b8f1a44e9a95dd0882ce19e9ee9d40ba45b8d43c3ab99ccb29f7e1b7acb6f3048eeb24d138a08",
                    workSkillsEtc: "71119da20a3b43d48ebf5e7115a574846003602fdbb94bb7907917ea86bddcc0b7b7510c773d41cdaab6764b4f515edd7ddce80417bb4c51b1ba15b482e24ad6639bd7ece04644b39de24776526cac45796a00a1261b489187f6d27be081fe1bf60aac41373d4b92a8107068f367632699023a811e8a4a7f809145412bf4ede8f8673f3d20224d27a389633022287c62f3d929471d7d41fd9dbc5f57e96006ee0af5307625e6488aa4e9f2f39b7ba39008ab150b7b0849989dd0499dbf22f63a56ba9506023d42d6a354d9cdc57d0f9319ed8f26a053488a8ca6a69df6497e621cc3432b3f52405d9d08292870891877986484a785ff4ef2b625",
                    extendedInformation: "0c019e95773047e48cb91aa00924aa732262d8f7fbc0403281f453602a77adbe3a5f90a866b44e8ba1f8d4134aca2190aa6234db71414f5eb6ef7aa1f8634d1d500e349551ad4959b22d264d5acd7b2ed62a8dce1ccb4fdeb485ef0bae362fffb9cfb3c404534f6b9ad409aa52bfa8270fa0db3ce9ce478b875b4dbd641cbcfca939b63f458b496395ce953c737d5b3f941998675298481b9f1d520a313bf22cbbb1022a140845b4abfa4cf3951f0e66f5e53407e2284c508b2bbc5043cc17969de099130963465696c9cce595459fcd062cb349d9314a869a66b234fe06021972f8cfe2654942c29d9a23268e283de6bca9d647987542958e19",
                    note: "432bcbae38204b7383f2e2b77ee34f87c769c34b22cf468aae238fc72cc39dc8ba2145d2a1e649968a0670d417c7d0ae1e3d02033f0842b087ef84b71de9e09f566bd0c8d0fd4822ae8bc996803fc5963a2d388acfd04388b39cb0fb95f7fc2ca0ff14fb4a0447fea8e8e92ca3ff7e13dc32e5ae6695455f911f1cb83af50f9fbbb4bb6d032f43d68fece7eca5769668d65b4d46d528463f9d22cf4e0d4d1786358ce74a22cd4431993ef5bbcb9d7e07957ba3ef0b144eeea4f96e5d64077d12ff8ea361a9d54f6dad2edd346ccf6fc532acfbb4ee174dd993ed5b2582516ab15bf79551ca974a09b633e61516f77b75be3e9ea4dde04a6582e6",
                    status: "a7074198d2b848f788cf58a0c7743fc432d0dc5e25ef4b2cb9"
                );

                // Assert
                result.ShouldBe(1);
            });
        }
    }
}