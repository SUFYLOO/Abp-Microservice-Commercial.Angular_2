using Shouldly;
using System;
using System.Linq;
using System.Threading.Tasks;
using Resume.ResumeSkills;
using Resume.EntityFrameworkCore;
using Xunit;

namespace Resume.ResumeSkills
{
    public class ResumeSkillRepositoryTests : ResumeEntityFrameworkCoreTestBase
    {
        private readonly IResumeSkillRepository _resumeSkillRepository;

        public ResumeSkillRepositoryTests()
        {
            _resumeSkillRepository = GetRequiredService<IResumeSkillRepository>();
        }

        [Fact]
        public async Task GetListAsync()
        {
            // Arrange
            await WithUnitOfWorkAsync(async () =>
            {
                // Act
                var result = await _resumeSkillRepository.GetListAsync(
                    resumeMainId: Guid.Parse("6b07ef9c-983c-4872-b98e-f82c0c8289b4"),
                    computerSkills: "0dd4fc8ff0a24d13af1e7caa6a11bd338e358d99b0d74ac19d2e268026143c8dcbecf6f51c1a4862927ed540a4dd0d546acacb28ff0a46c38410e40175206de49744907d205344b88fa8d48dfc2efe282d149050f31a4330a843e7f013584a2269927f9f2bc644829e7f3558aba460d738354a0b1f424b8382f52e8daca75007a2a5290043a84795b4d752f5145922a67ab3405c94a74fac8874fa4ef1b1829ebbc154f872b44e9d95abd782a4f25d304d605dadefdf4f9fa9d5301091139526527b8bb2bd334911a0534ca1ba06d146e7ca56b8c6fb44248a288189f3a7ce9c176497db0914402282bd800484fc96dbf47d0474fa1f4fefb2ac",
                    computerSkillsEtc: "eb764ef97d5f4f9384aebea82d4da1dee63ab67018ed44868206e55ce82af4c181ff1ea36065439ab633f89066d0fc38188b529c5df74f0abade3d0f3d884d981c5275cf7b5a43f98b5d7a9718a603b2cb0c750916e442cc9a3ac12cf2a00bd1d9882bc8d94240aba85a66d9a18e21cf31944edf12be450890edb7743435c96201a4491df0e843618d2575e8fa2d85bdd016eda6935f48bb98fb0cea69e5135faad853e245c54980805cb20a4ea67c7c018314ae4d6348ecbc2fd89e73d7e0fb053f2992e1434bf999873e43f34b5e0f22f943a8982848b5b5331306a42c1d9f861eeb8bcbdc4cf8b405527a5ef828bba59de0943abd448c83ff",
                    chineseTypingCode: "fcd3aa42252743d5a76cf6b9ac7bd8ab914defb00c1d448aab",
                    professionalLicense: "ea1f8780be5041b5a6ae2d6c34d0fc402bdaf1d1ac5748aaaad48561add2c083421d07180b0447eaa66c6492f2897a99cfc2c90d7fac4847a769fb18d367386649a91b86275841f8b21fa86ce3121016f370fdd70ae94086bd13610adc6050189831bbd3fa5f45d3a0f2622e56443498b4632a01481743f9b3df4c903a578d9abaa142ab76574a98a5e202ad4ba08898402b2249d2c14007aacf13d33065e2fc6687bd8c8b21408cb23b04c763fb9130227500d403bb414b9a9dfc18b56a96936ff6ca92db0a43f18e3244eb124d643d0c0b489441f74f0da7338a92ed390a70b60e8e011cf5446e8fdc119535fb64d673ee0dafc4424a5bacc8",
                    professionalLicenseEtc: "8e1a3f65c7f24ceea0cb2a288059c3b83c8ab9118b9e4054b065ca9e737acb9063d43e85cfc0447e9d90de8b7c555e3e555ea5e3b7e947e7b2a03d614988df904bf9dca7e88a4a22baf1b703ec50f5b5aa0db10862944db09bde89d9ceca31f0858a589a43414d3a9ea6615894886bfcaf209a096597476f9f6544d8a9af7c6fab5791cac839480fb2fc71f5abdf03ec9e6197da46e6487c954305e91d571d0fa690100c8c84461b91bb6d12738070831706e28f239e47e5988f9140e318524e3287593a53c34ffd8b7895fefa3a72996155111f0a6843b19c140a6e4724ebb234558d3653e54171a97d486416504fa3b634ba09dd4445c28306",
                    workSkills: "a141e7b9e47c4778a89b7706d704e6fc91e8e26da60a4dd1a5ed2822b26f393547e35744f2ec480c9efe7229e109c28b57200fdeda204f0aaf888e597f812c268e037fb8c2324183bc4f7ab07fc51a7a913a60128d9e4c4ea7f3cad8c7267ae8fc09650e9cfb4f6d90c71bf5ec559eeb360ccca99a0a41c08e1a41cb7515caec6bf051d866894a029624fd0ffb842ce551ab4dce729e400a8ba3b57b8ca61e3d2fecfe71834f4ec08999808016ad8095db5d8d3f7e5043d08b3920f70f7f2e5a01df2ebbed56400b82b7ead8e9e31cbfc0aaf8e6e2694d9fac43e80244bfde4e3f9a0101e22042779a39c78fe84b32e6685d9b219cfb44198912",
                    workSkillsEtc: "4834ec300f504f9a88d620d0bcc94401241e3ba396524841a58eb995b32fe90d68fe127b0ed74288a211fafda1a94c3e48b0e55a65d84f28881d5a363dab987b693a46f9ba04473d861bc6fa877f1a45c87b79bf783740f3a896a6f61b60e4ed78a2bd0c7a9d4bf88a5a88ee20bf1973cae3b22ec604410b80825ded2e9a74879fb81e4f16d0441896996ecd8b60b45950d99ad4ae5a4b389054db96ccc364fb235de58d1b1741bbad2566456aa56fb93cad00ce97de4fbd99352aa0dc3c85a8adb4c39a279e4808a8336e1fe683ec7c4cd22a48212c4d82abce8e413b0ee85c8dce49713fd94a6ab0a4e9a8e69ae4954b465f5647cd4a8d894b",
                    extendedInformation: "1926def72f4e4a4eb0c376763e5b91c94275f73700a14bab9806020d7c289904d9dd0c49651046d5ad9ed0276e743a307d49245544604cef9abfd89ac0992d62a3149a563acc429a82132b5898abc0c4496f8d6739474617a3814e3736172cb16b0ae0462d9b4bc4a37396133a24ac6c8631e7c60d4f4944a4418ccb9613fd38aa8020d6a42d4afd8d387e340916b9b0b9e088ee8ac5423da34acc93409a4215884e3e23cda544848dd57ecd9ea4c57baa1c7c307a3c4978be7b8e76f7b45d7e1735bc757bba409b9a33fbe321b5e0fdcc28aa1f9fdb48f3befe1be669d7b541675dafe8ef804e77a0cd2fb697567a2303bfb313407f4180973a",
                    note: "b90d4474de644897832ecd1159b2c55e99de0514a6f34132823ccd2621ee69b9039d7de5f46c4bd39c21e305c34140bb4bd77dbec10f43d5a7893eab9241fc7e77e20be4e49648c1bf7c20c40d1d8d75acf615d2fcf64850ac2a43f23f04a545eafcaac88afa4bcf83565e89217b7f50a94a223f087e4d2395005ef3d3cc1f64f0018351b0604fb2a78c56f682c5a952c758302287a84bc4b59ba124ce3a3c2d29dafa088640465ebaa445f42f664071e0ce40756c7c4a72b6bcc623f7de6523be343a970e1a40c384473d16d5b23d0f41de63dced224482be0e7b775b010fb042ac9efd080f43b4ac6644a6017409eb5637fcb4d4394d2db3da",
                    status: "301d366ab0454071b581d46ac2ab1dda0e34da807d144673bc"
                );

                // Assert
                result.Count.ShouldBe(1);
                result.FirstOrDefault().ShouldNotBe(null);
                result.First().Id.ShouldBe(Guid.Parse("c29284d3-75f4-4210-9f97-4234bcd881d1"));
            });
        }

        [Fact]
        public async Task GetCountAsync()
        {
            // Arrange
            await WithUnitOfWorkAsync(async () =>
            {
                // Act
                var result = await _resumeSkillRepository.GetCountAsync(
                    resumeMainId: Guid.Parse("ac33a925-990b-4b1f-9d86-3278e0aff75c"),
                    computerSkills: "ec1e73ce98e745b8bfd413219858291b7f4b88d0b69346ed9b21f0dc5669bf7d6d95ab36cd3f4a12a52810204dd155deb43f9a77f5c44f8499763783969387a18ec8a400192240ad8cbbca33e2fbc021725a90f6089b44d4855b47bd7238b13f62a0ceb184c04f13aae63c18cfca43a7d3bb5e22dad243a19bebb40e2a2cd7633b00f891974e4637bf67ca2d706e61625bc2d8ee4f7c48389bfe2026cf8f1f24d4339bd5202d43139416010aa1b2ef797ce58d3f76d647f0bef98427a1bf127ec51b8b1d25c64fb2bf374b4554fb8aaaddb15fd3be8f4b098a0278533c5aeba1a6655df6474649fe8a309cc37f658a8c3e89862469804ee884b2",
                    computerSkillsEtc: "cc26b775916a43e0a5dc1d83deb51c12393b9e2720ad4f2c8ddda8c8dd2042fe5ee8a9d8d7ca4337bf506198c1eb521a1acc66b4d42b447c89f98644a312c36454b4dd819c5f458ab7d21df14147e41c2d1b927d395047b9a6ddc41ff109b217ffb1896aa6484a3e873482d9e5ae25834b83fc02c13f47eb9f3e1770c6013ca9f0ff1715150c423eba84f2364327f6cf3ac2dff3b6ad4fccb1d425ffcbab162d039ae59ebcc44098879ef56ae8d86ae2b898414cb7c642c08fb483b92cfe375481334159f0f245c5ad79d6eb7dc75f2ada1a7ba8910e490fbc19317c5aef8440f6a7edc5ba5a4b88adafc009d2717a91c36ac21d7e254ab7aba1",
                    chineseTypingCode: "c45b2abeec0e4f83be11f49c0fda8dd14924f7529ee54ed986",
                    professionalLicense: "abb80a9c89a94ebe927f77b7a66343ba406843d42a0c49b3a508740f18780195a1b4ac70017643f19445d2fe2018c93dc944632efe2f450dbce94970e11d6baa634681eb78894e9288b39bf4513667ef3aa79e4e45c340e98058651920394ae00a2b97b5a0564621b7bb52f5bca87c7661fc97d9f5d042d4934be96d84ff924fc3c9523743e5428bb4ae170e0aa29ac6c2e581da6c654fa18a2ecb95d82a658e7873966d170d4bbcb242efc26e18184632cb5ed04edc47d990437c56d2bdae24271c8378232d4e50a5297deb6c8fd00db11169f6576340bd862d297791700543e633d7e5e7c84772bcc5ba2253e1265e8fb8924a4ac94634aab2",
                    professionalLicenseEtc: "5b2e6838c71a459f98dbdd4b235a760299b5962fe2174d97bcb029c0920508c604cafa1d47b64ee480e6625dcbeacdf07091bd55d13343eab75ab9954597d283f274e677b7524da199fd5b629ebff06118d245abf7b04cac86bfd15eff2635b3f134947d7df7495caf7efb8ae65741dd683503360efc46839d01120f876900cc7f50a64381b84eb7bff4d87e6797c1dfcfec22e330d14711a72f9af5cd2b5c37db6fbace434748d880451dbeb607129569b03446bac4487fbc7d84b896341ff7c7bd49c55b0b41a9840285fc981781340aef84f44b3741b38cec819e40397551d5ea76e727054c2fb87c9213b474a8b6274ebf3a853649a7b9ed",
                    workSkills: "10ffd9a9a462416cbe4b9297a1f06901cf8c674035ee413a8d044f5d302f894997b881fe5ac14457ad1ad3cedd5f2f57004c285423ec4c24aa74b0b36fc73232eaf342dc3a9d4b2cb2c16b41128f4a5b0bc271103cb04fa7a62977940b4708d75edcda24680c49a8ae377dd47e816d7c5e84c07c3ac44c608fd0979765ec0269d8d7ef6ecd334e24bf8a114d3183fe9dbb06b7b3b8674a98b57d508b9e435bf7b2eedcab65564adca8cae8a9f96aef4f72373a89dd7c4848a6e61aedc7e1f21ab9efa821c7da42928082d825ea98bb639b11d36be72845fba6bf910eb3c7e0a4cea79d74b87348a0b9be087a147ddf8ae9cd99f5203549698a5d",
                    workSkillsEtc: "2b40466c22c044b1a957d0244889777203186109bb7e4246aecba7d298c6c3e2ee2fe78d9891479a80cc2bf7cba3550327f33f2cd06044c78ccd31993be6dd5c0f82ed83d18e420996bc444d1b0e82c15d97d97daabe4344b6f9e2911ed6367c8235c8eba60d4e4c9bfeb86973cd2d48082ccf0cd9f84543b22fe8f2df4076693b76eeef2e14427f8dd56185131c536a7b193adf4f0e4a1fa3f0a72111f492b24b56195f52ff456bb992ba7183f1c13a2bf5a75308f5440f9287f88873a08c7ba9db927d64e14c89a9dc59b866a372618903d254f63c41a3b1bbe1faaabb6d20a4b10d69a488475fbd556da908dd048c48d2cfbec7ba4409b5fc",
                    extendedInformation: "18b6c73c503b4f90a7f70e5e4a704a686e4223ead6544f6796458a8d16689c1e690d9573443b4094a2265d2eb1f147cc9d66edbfcbf949fc9c4965f8908d3ee2a0c457345b0f48ff8b46c629155cbbeb54218bcea72f458ba1834a813cf0fe79b9be482811434c8ab6698e051b6065b223da0a3c36f4445394ac8c7bddadb5aa9990e4cb7cb04d9ba3a4381a0dbbb8c3b7280e9a9dcf48c2afebb88b74e3da9573e54f3ac9994dc580bfad24281bb99f01d6e323f3014918a092aa07999a99d7cc5e6146028e4899bf92da35d7c9a980ff60346f30f94fa9af0b82b6ca2498397a8a12a5fb1f46b38c9571cc4d4b2c148f80c9af68534ef6869a",
                    note: "8fe899a92a3049a78ca3e26dff4a0204a1431afe3cc945109f5479bcc968a65b9dea6034df3e443a9caf28ef1ad389a12b41cbe8bb4041ff8fa3a2a490ece964e83f8f31a4aa4a51ae9ed95329f23b7ad78af507e1834820815ff38d21f58c817c3ac96e15384623889a81c4da6cf87d7421a5abb2c644d4afe9c9268bf133084aca907537fc434ab3e4f7ebb784ae2d8e34042c7fee4a668493c6267ecccc6b9affabbf9f0e473d96f04231f6c33592e571323b295543a9aedabd75068a9b6e700b8bd59dc64e959f4883fb68c99765f0c9f7591153472c9a41f2d983b5ea322395dbd696b349ada127084416f8451e77f4cbca73384f9898a8",
                    status: "1c72b8de89414ab093b08e6a9bc63b9b6dcd6225e9314fe5be"
                );

                // Assert
                result.ShouldBe(1);
            });
        }
    }
}