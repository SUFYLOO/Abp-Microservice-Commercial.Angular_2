using System;
using System.Linq;
using Shouldly;
using System.Threading.Tasks;
using Volo.Abp.Domain.Repositories;
using Xunit;

namespace Resume.ShareMessageTpls
{
    public class ShareMessageTplsAppServiceTests : ResumeApplicationTestBase
    {
        private readonly IShareMessageTplsAppService _shareMessageTplsAppService;
        private readonly IRepository<ShareMessageTpl, Guid> _shareMessageTplRepository;

        public ShareMessageTplsAppServiceTests()
        {
            _shareMessageTplsAppService = GetRequiredService<IShareMessageTplsAppService>();
            _shareMessageTplRepository = GetRequiredService<IRepository<ShareMessageTpl, Guid>>();
        }

        [Fact]
        public async Task GetListAsync()
        {
            // Act
            var result = await _shareMessageTplsAppService.GetListAsync(new GetShareMessageTplsInput());

            // Assert
            result.TotalCount.ShouldBe(2);
            result.Items.Count.ShouldBe(2);
            result.Items.Any(x => x.Id == Guid.Parse("65862f0d-c6a2-43f7-bf65-71fd77c77228")).ShouldBe(true);
            result.Items.Any(x => x.Id == Guid.Parse("46feb87a-0b6e-4c05-85ba-f85d5a1d0f94")).ShouldBe(true);
        }

        [Fact]
        public async Task GetAsync()
        {
            // Act
            var result = await _shareMessageTplsAppService.GetAsync(Guid.Parse("65862f0d-c6a2-43f7-bf65-71fd77c77228"));

            // Assert
            result.ShouldNotBeNull();
            result.Id.ShouldBe(Guid.Parse("65862f0d-c6a2-43f7-bf65-71fd77c77228"));
        }

        [Fact]
        public async Task CreateAsync()
        {
            // Arrange
            var input = new ShareMessageTplCreateDto
            {
                Key1 = "702439d2d0084824bce3dba64aa7d8e29747e0c5df9948deb2",
                Key2 = "633c7cbdc09d4c94b36d45b2c719054c24fd345c37dc4732be",
                Key3 = "5e60dc7de960444b9054d81e13aae8dd8c9289fe2f6c42ad98",
                Name = "3e774e32d20542aaa8d7af7af5ce30dd30e412ac6c924934b4",
                Statement = "150c7b8a651b4811b3057b17b25a0e0e68bc05e31aba40c1834eb0e5d49874263587be39f2f4437f8f13a63982c3f3204b486aae51444d9c97db7d1a77e11104b5d3bb46d23a4330b457b3b1442664d88b963a9c1e754117a26d32385212a8bd2588d2b1c2984ae1922bbfa735c43b2900bdcc6e7bca4910ad1fd681762681a51750e71e3c5144489bafb31bd08f5277ce00b162fcf54141a68dc9168fd10812b9965105b7bd43a1afbcb050d92e87aad64cc7ca872d4a87b8943787f344f27b8334d352f4954e33a48b57981022ddd9703e41d5f6904f57a4f3effacde9256d30c09a10ab914184b329e48946406d76ab1d8a19d95341ae83be",
                TitleContents = "d0a80969481b40bf8f1b081e4d0c7127dfc75c85d23147fab282b84d65087fe366a2158eda26464dafcd9786051edd51f28e65f509784d02b7c5a00d098d9c7a437b818ed0d54050aa5f7fe53884bdef0cf871ee8ddb408195eb5f6f768505bfb02a7c6c98944b6f84cab94613e41a361ae81a22b9344e659dfd3d277bec628845db0a43be61437ea7faaa468daeff80d0731fbb9e744babbea3ebfb40951d9e188656a1f6064ce2b11d1f3ded26156255bd03ddb9104441b78e4f48b6d784fb3fcc8d64a5ec462a9dfc5aa115189a9f7f87a966cb2648c58e65797295d4e5900b21fca43bc04bbfbb1653487e04a15f9c1110ed798c4eb1b204",
                ContentMail = "21703f1f80694d97bdb5942295d84f443c8c0f88bce04151af06e6fe553d11498e679403f90a46d9b0",
                ContentSMS = "34085e0a66274a909a204e81fa29e4cb74d4d094a25e47c994e4d75c8dd6953d0e6cbd01f8934b9cbeb8d7a5a5058a35f4701194e5134c919cef8d87ff4f0bc71457894f73804564a1d8277f925c254e5a2f99d521d9491984a4b17fbefa9e3cea2887a1ebf14582857d4b95054d6d089bc40fc182ef4714b2ca73b5d95629e9426246a71b66401891e3b1a7084beb6428d5186f1c8544aba96c12406d1c9f858405baa8e7d548dfbdaf4acc3bb95094bbf7d36ebe3a4d9387cd5d344fe20c73f295db4b66654ae7967c87fe65665870d06fe270cfde47ce90cc9fe2d42d4ff926b74663738e4c579841efa7242496d80061c4ff61d94960b958",
                ExtendedInformation = "6fe7e347495a4d5690a53fcff72c419b4ffaa68ee0394ae3ac85fe8ffe3f799573ed45ec1d6d415fb8f02d8cc741e6ef0b58cc3c30aa44bc9aefeb51ce05d685c8abe9ccfd314e7db7ba4b6962779a3281f2f8a4bc674cf382fb87f5001c7a53107aca2779ce47e88545c4db55df7d28f3747ed23609429590e5d7661fd00355035aa3da48b84f9c8a4e01b1e17e9f748c1ff9906f2a4c518ccef3ae0a52933e494b15552ad742ce90feef612a110256324e671ff00043459d847dd30aa1060a239b33dfd0264153aac13d127a3ce6d76c3df90c46774d6f8b9cdeb518a1b31b7b47ed2e3be84422a954e9385dc3aee6d52d12d24a2f458aada5",
                DateA = new DateTime(2021, 5, 9),
                DateD = new DateTime(2007, 4, 26),
                Sort = 1797756018,
                Note = "87ecbdcc3b034e179d1293abf4f1dcdad61d24faab9d422b81bf73a4ad8457333b2d9020bdcc4001b13d352d3920a422ab8ca0d7b49d478ca551aff115bedaa71e98da88a6be4703a71db6bd53718078e0b9628334594af28246eb64130fa12204d352650a94417791e2f311780c9a4b4f3d35966f474a3e9dd7a7a710e5602a448de9cca60945e7a55042fe7e545ee2abada9c2beb643faabd69a70461014730186208b495848509b8e63369313285625530daaa58f4b778016c62cc4418b30f013448a9de44e26a30ba3cae8e9ab1e81b52dd4568046f3be046b7d33905b232906bc61712c4718bd385a403f9a3840de053b401b9046bb897e",
                Status = "00e51df7809b44999bf862ae856c895524bc1c92bc514d91a6"
            };

            // Act
            var serviceResult = await _shareMessageTplsAppService.CreateAsync(input);

            // Assert
            var result = await _shareMessageTplRepository.FindAsync(c => c.Id == serviceResult.Id);

            result.ShouldNotBe(null);
            result.Key1.ShouldBe("702439d2d0084824bce3dba64aa7d8e29747e0c5df9948deb2");
            result.Key2.ShouldBe("633c7cbdc09d4c94b36d45b2c719054c24fd345c37dc4732be");
            result.Key3.ShouldBe("5e60dc7de960444b9054d81e13aae8dd8c9289fe2f6c42ad98");
            result.Name.ShouldBe("3e774e32d20542aaa8d7af7af5ce30dd30e412ac6c924934b4");
            result.Statement.ShouldBe("150c7b8a651b4811b3057b17b25a0e0e68bc05e31aba40c1834eb0e5d49874263587be39f2f4437f8f13a63982c3f3204b486aae51444d9c97db7d1a77e11104b5d3bb46d23a4330b457b3b1442664d88b963a9c1e754117a26d32385212a8bd2588d2b1c2984ae1922bbfa735c43b2900bdcc6e7bca4910ad1fd681762681a51750e71e3c5144489bafb31bd08f5277ce00b162fcf54141a68dc9168fd10812b9965105b7bd43a1afbcb050d92e87aad64cc7ca872d4a87b8943787f344f27b8334d352f4954e33a48b57981022ddd9703e41d5f6904f57a4f3effacde9256d30c09a10ab914184b329e48946406d76ab1d8a19d95341ae83be");
            result.TitleContents.ShouldBe("d0a80969481b40bf8f1b081e4d0c7127dfc75c85d23147fab282b84d65087fe366a2158eda26464dafcd9786051edd51f28e65f509784d02b7c5a00d098d9c7a437b818ed0d54050aa5f7fe53884bdef0cf871ee8ddb408195eb5f6f768505bfb02a7c6c98944b6f84cab94613e41a361ae81a22b9344e659dfd3d277bec628845db0a43be61437ea7faaa468daeff80d0731fbb9e744babbea3ebfb40951d9e188656a1f6064ce2b11d1f3ded26156255bd03ddb9104441b78e4f48b6d784fb3fcc8d64a5ec462a9dfc5aa115189a9f7f87a966cb2648c58e65797295d4e5900b21fca43bc04bbfbb1653487e04a15f9c1110ed798c4eb1b204");
            result.ContentMail.ShouldBe("21703f1f80694d97bdb5942295d84f443c8c0f88bce04151af06e6fe553d11498e679403f90a46d9b0");
            result.ContentSMS.ShouldBe("34085e0a66274a909a204e81fa29e4cb74d4d094a25e47c994e4d75c8dd6953d0e6cbd01f8934b9cbeb8d7a5a5058a35f4701194e5134c919cef8d87ff4f0bc71457894f73804564a1d8277f925c254e5a2f99d521d9491984a4b17fbefa9e3cea2887a1ebf14582857d4b95054d6d089bc40fc182ef4714b2ca73b5d95629e9426246a71b66401891e3b1a7084beb6428d5186f1c8544aba96c12406d1c9f858405baa8e7d548dfbdaf4acc3bb95094bbf7d36ebe3a4d9387cd5d344fe20c73f295db4b66654ae7967c87fe65665870d06fe270cfde47ce90cc9fe2d42d4ff926b74663738e4c579841efa7242496d80061c4ff61d94960b958");
            result.ExtendedInformation.ShouldBe("6fe7e347495a4d5690a53fcff72c419b4ffaa68ee0394ae3ac85fe8ffe3f799573ed45ec1d6d415fb8f02d8cc741e6ef0b58cc3c30aa44bc9aefeb51ce05d685c8abe9ccfd314e7db7ba4b6962779a3281f2f8a4bc674cf382fb87f5001c7a53107aca2779ce47e88545c4db55df7d28f3747ed23609429590e5d7661fd00355035aa3da48b84f9c8a4e01b1e17e9f748c1ff9906f2a4c518ccef3ae0a52933e494b15552ad742ce90feef612a110256324e671ff00043459d847dd30aa1060a239b33dfd0264153aac13d127a3ce6d76c3df90c46774d6f8b9cdeb518a1b31b7b47ed2e3be84422a954e9385dc3aee6d52d12d24a2f458aada5");
            result.DateA.ShouldBe(new DateTime(2021, 5, 9));
            result.DateD.ShouldBe(new DateTime(2007, 4, 26));
            result.Sort.ShouldBe(1797756018);
            result.Note.ShouldBe("87ecbdcc3b034e179d1293abf4f1dcdad61d24faab9d422b81bf73a4ad8457333b2d9020bdcc4001b13d352d3920a422ab8ca0d7b49d478ca551aff115bedaa71e98da88a6be4703a71db6bd53718078e0b9628334594af28246eb64130fa12204d352650a94417791e2f311780c9a4b4f3d35966f474a3e9dd7a7a710e5602a448de9cca60945e7a55042fe7e545ee2abada9c2beb643faabd69a70461014730186208b495848509b8e63369313285625530daaa58f4b778016c62cc4418b30f013448a9de44e26a30ba3cae8e9ab1e81b52dd4568046f3be046b7d33905b232906bc61712c4718bd385a403f9a3840de053b401b9046bb897e");
            result.Status.ShouldBe("00e51df7809b44999bf862ae856c895524bc1c92bc514d91a6");
        }

        [Fact]
        public async Task UpdateAsync()
        {
            // Arrange
            var input = new ShareMessageTplUpdateDto()
            {
                Key1 = "09b1c90c63c546e2bc3e1f691d9a4846575dc7200b794adfbf",
                Key2 = "f92fed6a86c244448bcdbd46cdd562d53ebb4657480c4f86a4",
                Key3 = "78cd10f760ab497e9fec6bc637b32542b0a6a9aca0194154bb",
                Name = "a0d2820c60ef4f76945554552df855d0684a591929744365ab",
                Statement = "436376ed1f8b4fdea56d50ed3c77ea85e11d83a0282b497d92abf4283e8f7b70cfef0768a97f409fbc6b86ae251e7c5d653dd8d4c7024ccf9521e9df8e1e9c862917a352d8ac450583376e680a83628f3506c2b17571453a88a3394922a1bd41b4002349fe0b4524a182bc85d0e3f12dedb7c03be29a43639975535aae203116361e8029cb234410adb23c54a65de38ac0d204813af04984aff47eac0a3a6834dd5845e862954b73aa96142aa3ac9692c4e0f1522fcb49dca9be52632e16871820b8d3f5bc1f47949843b6c9152fcfe2c1daa2b66a6a4ccfad64e1bf84dc62c1e755b25f30af495f9a9ddb84619e3143ffa7c31c2aea41b68a6b",
                TitleContents = "21d298d9b9a6433a87fd9423652be4d4b3333dd1f60943cdaa316d1d897e0f16738752347d0544b0938216436c0a5ac31578dc3560aa4308b15a4c472a6fcdaf18527e02b0274268b58c5a52bf6989150c58065a8b964fda8177ef58755db1da02e371e5a9ab42f08e63e98e973e21c3380ad60ed2b24db998658d170dc92f331ade1ba221f84aab8d9a199c7a7bf6d9bfc4581f57d242889abcfee1eb7f40fb0993a444564e45858f19cb2b3dd26dda2ca78e05f81844d0bd3b9ac26ca338bbc06202c586ef4e968eb76b980c4bc438b2c3779e8eb34b5b817a76c6e1317866f5ebae37b34a446ea927c5a2e301acb4f4acd0dd69ee46639de6",
                ContentMail = "77dca508ff814610a8607cf332287dc8f1e8dc24c436453bb6fcbb3b6d0fad5d142fa02bbe604a1ca",
                ContentSMS = "8ea558f1c12542c892fd7164028cf4ea5f3bcf602f774c09a320dd95dd3b05f3cf55703c53f04776bab259a5b99283a6231dfa73e29f49bfb8ec47235a5e5251c90065f56634476597b4bc5e7642495a8ff288840a194997bc165d0bf08da1c8dbbcc05651444def81a1f2c838fce63b59ec1ad898e54789907c9b0f158ff56f3d2ab09c7b204b61ac56bfcada37527aa5c5cf5bc9254aeab5c93724608c2e035222dd3627af414aafd936ac11977eb92854ed08805f4b07a2f8a94f8d2b0b26919e39d917f344b38db944ee4c59078912cfab2b51bd4b3d831ef934b67d87b3e2d364a49a594f448762e5a205e2a878667a562b5c51415baa49",
                ExtendedInformation = "a7b26dfed3724a2da6c58e67fed9785782a2ee21c06d4528a8f460e91c2a8fe162fca5c836c0424db7ec0471192b6f5dc3c50a9e0eb349b8adb87325404c77566f5e9c53af9d44c7b0de758b29c8d003075ee164c9f34671b97491999fd527b5945d92f535af456ba9a105b3278b91fe85567f0054324de8b4f79dd0baef431c563c7590cdd8464cbfaccd8ede551ad6b374424a2aca4ac79a065674cd5bb0b134d554568a8a47db9f292e9fc6138d2714b5582f07c645be89dc544d48b388e045821f2a239640dfb60870177ddc8c4bb576236ae6fb4258bb121d70443dcb3636aab42dcbac4f89bf511728f1fc1f33dc0eecc413214dd8afd2",
                DateA = new DateTime(2003, 11, 19),
                DateD = new DateTime(2012, 10, 9),
                Sort = 1539715763,
                Note = "c2f8125c39ee4fe49c75827288bf2803bd21242132924761b37d40dd988d07abd1085d43533b470c9c22fee94e022f0bfc233a4c50614eea9dcef1beb81f4f9fb07107b07046447b9677dfaaaf01a48a157e1459d56344f99968c047bb0d66d60c57d0ad6ae04af29f1641edf5c2becb948eb7fd77974d8b83547c85dca9440f60bbc28e7a724d6bae075190d15ecced32e0693a155f4b5f8b36ee77ada4c9c1070267c1dbe445679db6a4a66075e755186984d480d148a1ab030399d192bed8bfb8517ea0454c99ab92fa3b1d8dd0bf7a8dff332f544dad91aa69616557fc6780cc13ab50844250bc663c291cbb4affac24c574958548f59d9c",
                Status = "5e1a64f3ec804e52ab32ad3b3bd1427a4bc49966a46c4927a2"
            };

            // Act
            var serviceResult = await _shareMessageTplsAppService.UpdateAsync(Guid.Parse("65862f0d-c6a2-43f7-bf65-71fd77c77228"), input);

            // Assert
            var result = await _shareMessageTplRepository.FindAsync(c => c.Id == serviceResult.Id);

            result.ShouldNotBe(null);
            result.Key1.ShouldBe("09b1c90c63c546e2bc3e1f691d9a4846575dc7200b794adfbf");
            result.Key2.ShouldBe("f92fed6a86c244448bcdbd46cdd562d53ebb4657480c4f86a4");
            result.Key3.ShouldBe("78cd10f760ab497e9fec6bc637b32542b0a6a9aca0194154bb");
            result.Name.ShouldBe("a0d2820c60ef4f76945554552df855d0684a591929744365ab");
            result.Statement.ShouldBe("436376ed1f8b4fdea56d50ed3c77ea85e11d83a0282b497d92abf4283e8f7b70cfef0768a97f409fbc6b86ae251e7c5d653dd8d4c7024ccf9521e9df8e1e9c862917a352d8ac450583376e680a83628f3506c2b17571453a88a3394922a1bd41b4002349fe0b4524a182bc85d0e3f12dedb7c03be29a43639975535aae203116361e8029cb234410adb23c54a65de38ac0d204813af04984aff47eac0a3a6834dd5845e862954b73aa96142aa3ac9692c4e0f1522fcb49dca9be52632e16871820b8d3f5bc1f47949843b6c9152fcfe2c1daa2b66a6a4ccfad64e1bf84dc62c1e755b25f30af495f9a9ddb84619e3143ffa7c31c2aea41b68a6b");
            result.TitleContents.ShouldBe("21d298d9b9a6433a87fd9423652be4d4b3333dd1f60943cdaa316d1d897e0f16738752347d0544b0938216436c0a5ac31578dc3560aa4308b15a4c472a6fcdaf18527e02b0274268b58c5a52bf6989150c58065a8b964fda8177ef58755db1da02e371e5a9ab42f08e63e98e973e21c3380ad60ed2b24db998658d170dc92f331ade1ba221f84aab8d9a199c7a7bf6d9bfc4581f57d242889abcfee1eb7f40fb0993a444564e45858f19cb2b3dd26dda2ca78e05f81844d0bd3b9ac26ca338bbc06202c586ef4e968eb76b980c4bc438b2c3779e8eb34b5b817a76c6e1317866f5ebae37b34a446ea927c5a2e301acb4f4acd0dd69ee46639de6");
            result.ContentMail.ShouldBe("77dca508ff814610a8607cf332287dc8f1e8dc24c436453bb6fcbb3b6d0fad5d142fa02bbe604a1ca");
            result.ContentSMS.ShouldBe("8ea558f1c12542c892fd7164028cf4ea5f3bcf602f774c09a320dd95dd3b05f3cf55703c53f04776bab259a5b99283a6231dfa73e29f49bfb8ec47235a5e5251c90065f56634476597b4bc5e7642495a8ff288840a194997bc165d0bf08da1c8dbbcc05651444def81a1f2c838fce63b59ec1ad898e54789907c9b0f158ff56f3d2ab09c7b204b61ac56bfcada37527aa5c5cf5bc9254aeab5c93724608c2e035222dd3627af414aafd936ac11977eb92854ed08805f4b07a2f8a94f8d2b0b26919e39d917f344b38db944ee4c59078912cfab2b51bd4b3d831ef934b67d87b3e2d364a49a594f448762e5a205e2a878667a562b5c51415baa49");
            result.ExtendedInformation.ShouldBe("a7b26dfed3724a2da6c58e67fed9785782a2ee21c06d4528a8f460e91c2a8fe162fca5c836c0424db7ec0471192b6f5dc3c50a9e0eb349b8adb87325404c77566f5e9c53af9d44c7b0de758b29c8d003075ee164c9f34671b97491999fd527b5945d92f535af456ba9a105b3278b91fe85567f0054324de8b4f79dd0baef431c563c7590cdd8464cbfaccd8ede551ad6b374424a2aca4ac79a065674cd5bb0b134d554568a8a47db9f292e9fc6138d2714b5582f07c645be89dc544d48b388e045821f2a239640dfb60870177ddc8c4bb576236ae6fb4258bb121d70443dcb3636aab42dcbac4f89bf511728f1fc1f33dc0eecc413214dd8afd2");
            result.DateA.ShouldBe(new DateTime(2003, 11, 19));
            result.DateD.ShouldBe(new DateTime(2012, 10, 9));
            result.Sort.ShouldBe(1539715763);
            result.Note.ShouldBe("c2f8125c39ee4fe49c75827288bf2803bd21242132924761b37d40dd988d07abd1085d43533b470c9c22fee94e022f0bfc233a4c50614eea9dcef1beb81f4f9fb07107b07046447b9677dfaaaf01a48a157e1459d56344f99968c047bb0d66d60c57d0ad6ae04af29f1641edf5c2becb948eb7fd77974d8b83547c85dca9440f60bbc28e7a724d6bae075190d15ecced32e0693a155f4b5f8b36ee77ada4c9c1070267c1dbe445679db6a4a66075e755186984d480d148a1ab030399d192bed8bfb8517ea0454c99ab92fa3b1d8dd0bf7a8dff332f544dad91aa69616557fc6780cc13ab50844250bc663c291cbb4affac24c574958548f59d9c");
            result.Status.ShouldBe("5e1a64f3ec804e52ab32ad3b3bd1427a4bc49966a46c4927a2");
        }

        [Fact]
        public async Task DeleteAsync()
        {
            // Act
            await _shareMessageTplsAppService.DeleteAsync(Guid.Parse("65862f0d-c6a2-43f7-bf65-71fd77c77228"));

            // Assert
            var result = await _shareMessageTplRepository.FindAsync(c => c.Id == Guid.Parse("65862f0d-c6a2-43f7-bf65-71fd77c77228"));

            result.ShouldBeNull();
        }
    }
}